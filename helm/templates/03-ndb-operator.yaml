apiVersion: apps/v1
kind: Deployment
metadata:
  name: ndb-operator
  namespace:  {{ if and (.Values.operator.global) (eq .Values.operator.namespace "ndb-operator") }}ndb-operator{{ else }}{{ .Values.operator.namespace}}{{ end }}
  labels:
    release: 0.0.1
    app: ndb-operator
spec:
  replicas: 1
  selector:
    matchLabels:
      app: ndb-operator
  template:
    metadata:
      labels:
        app: ndb-operator
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8080"
    spec:
      serviceAccountName: ndb-operator
      {{- if .Values.imagePullSecretName }}
      imagePullSecrets:
      - name: {{.Values.imagePullSecretName}}
      {{- end }}
      containers:
      - name: ndb-operator-controller
        image: {{.Values.image}}
        imagePullPolicy: {{.Values.imagePullPolicy}}
        ports:
        - containerPort: 1186
